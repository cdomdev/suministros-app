import{j as e}from"./jsx-runtime.D5qyYPMi.js";import{r as a,R as E}from"./index.CZlPm10g.js";import{F as M,b as I,a as k,E as y}from"./formik.esm.CnOOgvCf.js";import{v as _,g as L}from"./auth.DD4wRTWl.js";import{T as S}from"./Toast.ClEPDOpx.js";import{a as N}from"./axios.C8DqakIB.js";import{M as j}from"./Modal.BWYwa0w5.js";const G=({setShow:n})=>{const[i,r]=a.useState(""),[c,s]=a.useState(!1),[d,l]=a.useState(""),u=async o=>{try{const t=await _(o);t.status===200&&(n(!1),window.location.reload(),localStorage.setItem("infoProfileUSer",JSON.stringify(t.data)))}catch(t){if(N.isAxiosError(t)&&t.response){const{status:m}=t.response;m===404?(l("fail"),s(!0),r(`El email ${o.email} no esta registrado`),setTimeout(()=>{s(!1)},5e3)):m===401&&(l("fail"),s(!0),r("Datos incorrectos, verifica tus datos eh intentalo de nuevo"),setTimeout(()=>{s(!1)},5e3))}l("fail"),s(!0),r("Hubo un error al verificar tus datos, intentalo de nuevo"),setTimeout(()=>{s(!1)},5e3)}};return e.jsxs(e.Fragment,{children:[e.jsx(S,{showToast:c,setShowToast:s,toastMessage:i,setToastMessage:r,bgToast:d,setBgToast:l}),e.jsx(M,{initialValues:{email:"",password:""},validate:o=>{const t={};return o.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(o.email)||(t.email="Ingrese una dirección de correo válida"):t.email="¡Este campo no puede quedar vacio!",o.password||(t.password="¡Este campo no puede quedar vacio!"),t},onSubmit:u,children:({handleSubmit:o})=>e.jsxs(I,{onSubmit:o,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Ingrese su correo"}),e.jsx(k,{type:"email",id:"email",name:"email",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-200 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 dark:shadow-sm-light",placeholder:"example@sumi.com"}),e.jsx(y,{name:"email",component:"div",className:"text-red-500 text-sm mt-1"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-900 dark:text-white",children:"Ingrese su contraseña"}),e.jsx("a",{href:"/Olvide-mi-contraseña",className:"text-blue-700 hover:underline duration-150 text-sm flex justify-end px-1",children:"Olvidé mi contraseña"})]}),e.jsx(k,{type:"password",id:"password",name:"password",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-200 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 dark:shadow-sm-light"}),e.jsx(y,{name:"password",component:"div",className:"text-red-500 text-sm mt-1"})]}),e.jsx("button",{type:"submit",className:"text-white text-xs md:text-sm bg-blue-700 w-full hover:bg-blue-800 focus:ring-4 mb-3 focus:outline-none focus:ring-blue-300 font-medium rounded-lg px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Iniciar sesión"}),e.jsxs("div",{className:"w-full flex gap-2 items-center text-xs md:text-sm",children:[e.jsx("p",{className:"py-2",children:"¿No tienes cuenta?"}),e.jsx("a",{href:"/registro",className:"underline hover:text-blue-500 duration-150",children:"Regístrate aquí"})]})]})})]})},O=()=>e.jsxs("svg",{className:"icon size-8",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"100",height:"100",viewBox:"0 0 48 48",children:[e.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),e.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),e.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),e.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]});function H(n={}){const{nonce:i,onScriptLoadSuccess:r,onScriptLoadError:c}=n,[s,d]=a.useState(!1),l=a.useRef(r);l.current=r;const u=a.useRef(c);return u.current=c,a.useEffect(()=>{const o=document.createElement("script");return o.src="https://accounts.google.com/gsi/client",o.async=!0,o.defer=!0,o.nonce=i,o.onload=()=>{var t;d(!0),(t=l.current)===null||t===void 0||t.call(l)},o.onerror=()=>{var t;d(!1),(t=u.current)===null||t===void 0||t.call(u)},document.body.appendChild(o),()=>{document.body.removeChild(o)}},[i]),s}const C=a.createContext(null);function z({clientId:n,nonce:i,onScriptLoadSuccess:r,onScriptLoadError:c,children:s}){const d=H({nonce:i,onScriptLoadSuccess:r,onScriptLoadError:c}),l=a.useMemo(()=>({clientId:n,scriptLoadedSuccessfully:d}),[n,d]);return E.createElement(C.Provider,{value:l},s)}function B(){const n=a.useContext(C);if(!n)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return n}function q({flow:n="implicit",scope:i="",onSuccess:r,onError:c,onNonOAuthError:s,overrideScope:d,state:l,...u}){const{clientId:o,scriptLoadedSuccessfully:t}=B(),m=a.useRef(),b=a.useRef(r);b.current=r;const p=a.useRef(c);p.current=c;const v=a.useRef(s);v.current=s,a.useEffect(()=>{var f,x;if(!t)return;const F=n==="implicit"?"initTokenClient":"initCodeClient",R=(x=(f=window?.google)===null||f===void 0?void 0:f.accounts)===null||x===void 0?void 0:x.oauth2[F]({client_id:o,scope:d?i:`openid profile email ${i}`,callback:h=>{var g,w;if(h.error)return(g=p.current)===null||g===void 0?void 0:g.call(p,h);(w=b.current)===null||w===void 0||w.call(b,h)},error_callback:h=>{var g;(g=v.current)===null||g===void 0||g.call(v,h)},state:l,...u});m.current=R},[o,t,n,i,l]);const T=a.useCallback(f=>{var x;return(x=m.current)===null||x===void 0?void 0:x.requestAccessToken(f)},[]),A=a.useCallback(()=>{var f;return(f=m.current)===null||f===void 0?void 0:f.requestCode()},[]);return n==="implicit"?T:A}const P="723138540512-ves2et54j3deoj0br2memorcba9e829s.apps.googleusercontent.com",D=({setShow:n})=>e.jsx(z,{clientId:P,children:e.jsx(V,{setShow:n})}),V=({setShow:n})=>{const[i,r]=a.useState(""),[c,s]=a.useState(!1),[d,l]=a.useState(""),u=q({onSuccess:async o=>{try{const t=await L(o);t.status===200&&(window.location.reload(),n(!1),localStorage.setItem("infoProfileUSer",JSON.stringify(t.data)))}catch(t){if(N.isAxiosError(t)&&t.response){const{status:m}=t.response;m===404?(l("fail"),s(!0),r("Algo salio mal con el inicio, intentalo de nuevo"),setTimeout(()=>{s(!1)},5e3)):m===401&&(l("fail"),s(!0),r("Datos incorrectos, verifica tus datos eh intentalo de nuevo"),setTimeout(()=>{s(!1)},5e3))}}}});return e.jsxs(e.Fragment,{children:[e.jsx(S,{showToast:c,setShowToast:s,toastMessage:i,setToastMessage:r,bgToast:d,setBgToast:l}),e.jsxs("button",{onClick:()=>u(),className:"border w-full flex rounded-md gap-1 font-normal  justify-center items-center py-1 cursor-pointer mb-3 hover:bg-blue-500 duration-150 hover:text-white",children:[e.jsx("span",{className:"block bg-white rounded-full",children:e.jsx(O,{})}),e.jsx("span",{className:"text-sm",children:"Iniciar sesion con google"})]})]})},X=({triggerElement:n})=>{const[i,r]=a.useState(!1),c=()=>r(!1),s=()=>r(!0);return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:s,children:n}),i&&e.jsx("div",{id:"box-backdrop",className:"fixed inset-0 bg-gray-900/50 z-40"}),e.jsxs(j,{show:i,onHide:c,children:[e.jsx(j.Header,{closeButton:!0,className:"border-none px-4 pt-4 pb-1"}),e.jsx("div",{className:"font-font-cust-2 p-2",children:e.jsxs(j.Body,{children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-center text-black dark:text-white",children:"Inicia sesion con tu cuenta de google"}),e.jsx(D,{setShow:r}),e.jsxs("div",{className:"flex items-center justify-center mb-2 gap-2",children:[e.jsx("hr",{className:"border-2 border-black w-[50%]"}),e.jsx("span",{className:"block text-sm font-semibold",children:"o"}),e.jsx("hr",{className:"border-2 border-black w-[50%]"})]}),e.jsx(G,{setShow:r})]})})]})]})};export{X as M};
