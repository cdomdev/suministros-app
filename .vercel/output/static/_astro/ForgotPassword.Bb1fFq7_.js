import{j as e}from"./jsx-runtime.D5qyYPMi.js";import{F as j,a as S,E as v}from"./formik.esm.CnOOgvCf.js";import{r}from"./index.CZlPm10g.js";import{a as y}from"./axios.C8DqakIB.js";import{T as N}from"./Toast.ClEPDOpx.js";import{s as w}from"./auth.DD4wRTWl.js";import{F as l}from"./Form.Cl2sH4GS.js";import{B as E}from"./Button.BUnclwoi.js";import{S as T}from"./Spinner.Bod7GEZV.js";import"./ThemeProvider.C_HRE9zQ.js";import"./index.CFq_IdT0.js";const k=({email:n})=>e.jsxs("div",{className:"flex flex-col justify-center items-center",children:[e.jsx("h1",{className:"mb-2 font-text-base md:text-base text-center text-green-600",children:"¡Tu informacion ah sido valida con exito!"}),e.jsxs("p",{className:"text-xs md:text-sm font-normal text-balance text-center",children:["En los proximos minutos enviaremos un correo a tu cuenta ",e.jsx("strong",{children:n})," con las instrucciones para ingresar una nueva contraseña"]}),e.jsx("a",{href:"/",className:"my-2 text-center hover:underline duration-150",children:"Volver a la pagina de inicio"})]}),J=()=>{const[n,m]=r.useState(!1),[x,c]=r.useState(),[d,f]=r.useState(),[g,o]=r.useState(""),[p,a]=r.useState(!1),[b,i]=r.useState("");r.useEffect(()=>{const t=localStorage.getItem("isSuccessSend");if(t){let s=JSON.parse(t);c(s)}},[]);const h=async t=>{m(!0);try{const s=await w(t);s&&s.status===200&&(c(!0),f(s.data),localStorage.setItem("isSuccessSend",JSON.stringify(!0)))}catch(s){if(y.isAxiosError(s)&&s.response){const{status:u}=s.response;u===404?(i("fail"),a(!0),o(`El email ${t.email} no esta registrado`),setTimeout(()=>{a(!1)},5e3)):u===401&&(i("fail"),a(!0),o("Datos incorrectos, verifica tus datos eh intentalo de nuevo"),setTimeout(()=>{a(!1)},5e3))}i("fail"),a(!0),o("algo salio mal, por favor intenlado mas tarde"),setTimeout(()=>{a(!1)},5e3)}finally{m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(N,{showToast:p,setShowToast:a,toastMessage:g,setToastMessage:o,bgToast:b,setBgToast:i}),x?e.jsx(k,{email:d?.email,nombre:d?.nombre}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"mb-2 font-normal text-base md:text-lg",children:"Solicitud para restablecer contraseña"}),e.jsxs("p",{className:"text-xs md:text-sm font-normal",children:["Por motivos de seguridad, su clave olvidada debe ser reemplazada por una nueva. ",e.jsx("br",{})," Ingrese el correo con el que se registro en suministros"]}),e.jsx("div",{className:"w-full md:w-[56%]",children:e.jsx(j,{initialValues:{email:""},validate:t=>{const s={};return t.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)||(s.email="Ingrese un correo electrónico válido"):s.email="*Este campo no puede quedar vacio*",s},onSubmit:h,children:t=>e.jsxs(l,{className:"form-recovery",onSubmit:t.handleSubmit,children:[e.jsxs(l.Group,{className:"mb-3 form-login",children:[e.jsx(l.Label,{className:"block my-2  text-xs md:text-sm font-medium text-gray-900 dark:text-white",children:"Ingrese su correo electrónico ∗"}),e.jsx(S,{type:"email",name:"email",placeholder:"Email@example.com",className:"bg-gray-50 border border-gray-300 text-gray-900 text-xs md:text-sm rounded-lg focus:ring-blue-200 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 dark:shadow-sm-light"}),e.jsx(v,{name:"email",component:"div",className:"text-danger text-sm"})]}),e.jsx(E,{variant:"primary",type:"submit",className:"btn-recovery-password w-full text-xs md:text-sm py-2",disabled:t.isSubmitting,children:n?e.jsx("div",{className:"spinner-container",children:e.jsx(T,{animation:"border",role:"status",size:"sm"})}):e.jsx(e.Fragment,{children:"Enviar solicitud para restablecer contraseña"})})]})})})]})]})};export{J as default};
