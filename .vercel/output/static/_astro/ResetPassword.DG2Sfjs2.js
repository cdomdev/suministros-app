import{j as e}from"./jsx-runtime.D5qyYPMi.js";import{F as k,a as m,E as u}from"./formik.esm.CnOOgvCf.js";import{r}from"./index.CZlPm10g.js";import{a as y}from"./auth.DD4wRTWl.js";import{a as N}from"./axios.C8DqakIB.js";import{T as S}from"./Toast.ClEPDOpx.js";import{F as o}from"./Form.Cl2sH4GS.js";import{B as v}from"./Button.BUnclwoi.js";import{S as L}from"./Spinner.Bod7GEZV.js";import"./ThemeProvider.C_HRE9zQ.js";import"./index.CFq_IdT0.js";const T=()=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-circle-check size-14",width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#00b341",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),e.jsx("path",{d:"M9 12l2 2l4 -4"})]})}),e.jsx("h1",{className:"text-base font-normal",children:"Tu contraseña se actuilizo con exito, ya puedes iniciar sesion en Suministros"}),e.jsx("a",{href:"/",className:"mt-4  text-center px-10 py-2  rounded-md hover:underline",children:"Regresar al inicio"})]}),i=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-check size-4",width:"44",height:"44",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"#00b341",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M5 12l5 5l10 -10"})]}),q=({token:x})=>{const[p,c]=r.useState(!1),[h,l]=r.useState(!1),[b,t]=r.useState(""),[f,n]=r.useState(!1),[g,d]=r.useState("");r.useEffect(()=>{const a=localStorage.getItem("processSucces");if(a){const s=JSON.parse(a);c(s)}},[]);const w=async a=>{l(!0);try{const s=await y({values:a,token:x});s&&s.status===200&&(c(!0),localStorage.setItem("processSucces",JSON.stringify(!0)))}catch(s){if(console.log(s),N.isAxiosError(s)&&s.response){const{status:j}=s.response;switch(j){case 401:t("No pudimos hacer esto, intenta de nuevo.");break;case 400:t('El token ha expirado. Solicita un nuevo cambio desde la sección "Olvidé mi contraseña".');break;default:t("Ocurrió un error. Por favor, intenta más tarde.");break}}d("fail"),n(!0),t("Ocurrió un error. Por favor, intenta más tarde."),setTimeout(()=>n(!1),5e3)}finally{l(!1)}};return e.jsxs("div",{className:"font-font-cust-2",children:[e.jsx(S,{showToast:f,setShowToast:n,toastMessage:b,setToastMessage:t,bgToast:g,setBgToast:d}),p?e.jsx(T,{}):e.jsxs("div",{className:"container-recovery",children:[e.jsx("h1",{className:"text-center mb-3 text-base md:text-lg",children:"Solicitud para restablecer contraseña"}),e.jsx("h2",{className:"font-normal text-sm md:text-base mb-2",children:"A continuación encontrará un formulario para restablecer su contraseña, por favor siga las indicaciones"}),e.jsxs("ul",{className:"text-sm pl-3",children:[e.jsxs("li",{className:"flex gap-1",children:[e.jsx(i,{}),"Ingrese una nueva contraseña"]}),e.jsxs("li",{className:"flex gap-1",children:[e.jsx(i,{}),"Confirme la contraseña"]}),e.jsxs("li",{className:"flex gap-1",children:[e.jsx(i,{}),"La contraseña debe contener al menos una mayúscula, una minúscula, un número y tener un minimo de 5 y un máximo de 10 caracteres"]})]}),e.jsx(k,{initialValues:{password:"",password2:""},validate:a=>{const s={};return a.password?/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{5,10}$/.test(a.password)||(s.password="La contraseña debe contener al menos una mayúscula, una minúscula, un número y tener un minimo de 5 y un máximo de 10 caracteres"):s.password="Se requiere una contraseña",a.password2?a.password!==a.password2&&(s.password2="Las contraseñas deben coincidir"):s.password2="Se requiere confirmar la contraseña",s},onSubmit:w,children:a=>e.jsxs(o,{className:"form-recovery",onSubmit:a.handleSubmit,children:[e.jsxs(o.Group,{className:"mb-3 form-login",children:[e.jsx(o.Label,{className:"mt-2 pass block mb-2 text-sm font-medium text-gray-900 dark:text-white ",children:"Ingrese una nueva contraseña"}),e.jsx(m,{type:"password",name:"password",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-200 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 dark:shadow-sm-light"}),e.jsx(u,{name:"password",component:"div",className:"text-danger text-sm"})]}),e.jsxs(o.Group,{className:"mb-3 form-login",children:[e.jsx(o.Label,{className:"mt-2 block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Confirme la contraseña"}),e.jsx(m,{type:"password",name:"password2",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-200 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 dark:shadow-sm-light"}),e.jsx(u,{name:"password2",component:"div",className:"text-danger text-sm"})]}),e.jsx(v,{variant:"primary",type:"submit",className:"btn-recovery-password w-full text-sm py-2",disabled:a.isSubmitting,children:h?e.jsx("div",{className:"spinner-container",children:e.jsx(L,{animation:"border",role:"status",size:"sm"})}):e.jsx(e.Fragment,{children:"Restablecer contraseña"})})]})})]})]})};export{q as FormResetPassword};
